digraph G{
	node [style=filled fillcolor=white]

	root[label="Obtain consumer profile",shape=OR];	

	root -> profile;
	buyProfile[label="Buy Profile"];
	root -> buyProfile;

	buy_third_party2[label="Buy from 3rd party"];
	buyProfile ->  buy_third_party2;

	profile[label="Profile consumer",shape=AND];

	obtain_information[label="Obtain power consumption",shape=OR];
	analyse_power_consumption[label="Analyze power consumption",shape=OR];

	compromise_sm[label="Compromise SM",shape=OR];
	compromise_sm -> obtainPassword;
	exploitVulnerability[label="Vulnerabilities"];
		compromise_sm -> exploitVulnerability;

		obtainPassword[shape=OR];
		obtainPassword -> phishing;
		malware2[label="malware"];
		obtainPassword -> malware2;
		obtainPassword -> crackPassword;

		exploitVulnerability[shape=AND];
		findVuln[label="Find Vulnerability"];
		exploitVulnerability -> findVuln;
		exploitVuln[label="Exploit Vulnerability"];
		exploitVulnerability -> exploitVuln;

		hack_client[label="Compromise client",shape=OR];
		buy_information[label="Buy power consumption",shape=OR];
	residents[label="Number of residents"];
	home[label="Residents home schedule"];
	activity_residents[label="Residents activity schedule"];
	when_appl[label="Appliances usage"];
	what_appl[label="Appliance brands",shape=AND];

	buy_third_party[label="Buy from 3rd party"];
	buy_from_consumer[label="Buy from consumer"];
	
	malware[label="Use Malware"];
	physical[label="Steal client"];
	power_signatures[label="Obtain power signatures"];
	power_compare[label="Compare with \nsignature database"];
	

	profile -> obtain_information, analyse_power_consumption;
	obtain_information -> compromise_sm, hack_client, buy_information;
	analyse_power_consumption ->  residents, activity_residents, home, when_appl, what_appl;
	buy_information -> buy_third_party, buy_from_consumer;
	hack_client -> malware, physical;

	what_appl -> power_signatures, power_compare;
	
	}