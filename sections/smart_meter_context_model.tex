%!TEX root = ../master.tex
\section{Smart Meter Context Model}\label{sec:smartmetercontext}
As no fully implemented smart meter systems currently exist, a lot of assumptions will have to be made before it is possible to imagine how such a system could be attacked.
We do this in two steps.

The first step taken is to outline the system as closely as possible.
Since there is no single correct system architecture, we have chosen the one opted by our native country: Denmark.
This system outline is based on the sources and information gained in the previous sections.

\subsection{The smart meter system}
The system is pictured in \cref{contextual:system}.
The black lines indicate information flow between actors in the system.
The \emph{consumer} can interact, through a client, with the \emph{smart meter} in order to control \emph{smart appliances} and monitor the production of his \emph{home production} devices.
The \emph{data hub} stores the consumption data of the consumer.
This data is available for the \emph{consumer}, the \emph{distribution companies} and the \emph{electrical companies}.
These three actors have permission to see the consumption data in different granularities.
The consumer can see the data in the finest granularity, whereas the distribution companies and the electrical companies has access to a coarser granularity that makes it possible for them to calculate the bill.
The electrical companies send price information to the data hub, which the consumer can see through the smart meter.

Power in the system is indicated by a red line.
Power flows from a power source and from home production to the smart meter which powers appliances in the home.

Finally, the \emph{smart meter manufacturers} have physical access in order to install and maintain smart meters, as well as the ability to update firmware.
This is indicated by the blue line.

\begin{figure}[h]
  \centering
  \input{figures/system.tikz}
  \caption{The smart meter system\cite{tdlm}}
  \label{contextual:system}
\end{figure}

\subsection{Actors and threats}
Placing a smart meter in a consumers home and simultaneously requiring external access to its data is a complicated task with many potential risks.
\Cref{contextual:sm_model} represents this context and the actors therein.
This has been used as a starting point for a brainstorm that maps the potential attacks on the system.

\begin{figure}[h]
  \centering
  \input{figures/smart_meter_context_model.tikz}
  \caption{The smart meter context model}
  \label{contextual:sm_model}
\end{figure}

\paragraph{Actors}\label{contextActors}
Below is the list of the actors represented in the full system and context.
The list below will briefly describe the actors, their objective, and how they can abuse a smart meter to achieve their objective.
\begin{itemize}
\item \textbf{Consumer}\\
The resident of the depicted home and the one whose power consumption is monitored.
The smart meter is installed in the consumer's home.
The consumer may want to attack his own smart meter in order to reduce his power bill.
\item \textbf{Burglar}\\ A burglar can use the smart meter to find out when the consumer is home, in order to break in, as well as finding out which products the consumer owns, in order to assess him as a target.
\item \textbf{Neighbor}\\
The next door neighbor to the consumer.
We assume that the neighbor will perform attacks on the consumer in order to remove annoyances, such as loud appliances or music.
In case of neighborly disputes, messing with the SM and connected appliances could also be viable strikes.
\item \textbf{Partner}\\
The consumer's partner.
In this context there is no distinction between a partner who is living with the consumer and one that is not.
The partner would like to surveil or get revenge over the consumer, in case of misdoings on the consumer's part -- such as adultery.

\item \textbf{Electrical Company}\\
The company billing the consumer for his power consumption.
The electrical company may want to increase the bill of the consumer.
\item \textbf{Distribution Company}\\
Manages the part of the grid closest to the consumer and provides him with electricity.
Installs the smart meters in the consumer's home.
Government-controlled intermediary between the electrical company and the consumer.
The distribution company therefore has no gain from abusing the smart meter.
\item \textbf{External}
\begin{itemize}
\item \textbf{Information gatherers}\\ 
Some companies depend on information about consumers and can use the information provided by the smart meter to profile consumers.
\item \textbf{Developers of third party apps}\\
The developer of apps that the consumer will use for monitoring his electrical consumption. 
These apps can be either mobile, desktop, and web applications.
The information gatherer can abuse this position in order to collect data about the consumer and possibly sell it.
\item \textbf{Appliance company}\\ The provider of home appliances that can connect with the smart meter.
Can collect data through appliances and possibly sell it.
\item \textbf{Government}\\
The government officials (including counties and municipalities).
\item \textbf{States}\\ In countries with tension between them, one country could have an interest in abusing smart meters to attack citizens of the opposing country.
\item \textbf{Terrorist organisations}\\ Terrorists can abuse the smart meter for terrorist acts, like shutting off power in a city or region.
\item \textbf{Environmental activists}\\ Activists can abuse the smart meter as a means of demonstrating environmental politics.
\item \textbf{Blackmailer}\\ A criminal who switches off all, or some, smart meters from an electrical company and demands money for switching them on again.
\end{itemize}
\end{itemize}

\paragraph{Objects}
\begin{itemize}
\item \textbf{Smart Meter}\\ Controls and records power consumption for home appliances.
\item \textbf{Smart Appliance}\\ Optionally controlled from the smart meter.
For instance a washing machine can be started and stopped when scheduled.
\item \textbf{Data Hub}\\ Consumption data is stored on the Data Hub, which makes it available for the distributor and the electrical company.
\item \textbf{Home Production}\\ The consumer can connect his own home production devices such as solar cells or windmills.
\end{itemize}

\subsubsection{Smart Meter}
The following describes the conceptual smart meter we have used in our considerations, based on \cref{smart_grid_smart_meter}, \citet{tdlm}, and \citet{smart_meter_survey}.
These assumptions will be used throughout the report.
\begin{itemize}
	\item The smart meter is installed in the household of the consumer, in this case a house.
	\item Home appliances are connected to the smart meter and can be managed from it.
	\item The smart meter can be accessed through an API.
	\item The consumer can access and manage his home appliances connected to the smart meter through some sort of program, e.g. an app developed by a third party.
	\item The smart meter manufacturer has the ability to update firmware. 
	\item The home appliance company can update the firmware of their appliances through the smart meter.
	\item The smart meter sends its consumption data to the Data Hub.
	\item The electrical company have the ability to switch off the smart meter 
	\item The electical company obtains billing information from the Data Hub.
	\item Home production of electricity, for instance a windmill, is also connected to the smart meter.
\end{itemize}

